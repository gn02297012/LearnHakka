<html>
    <head>
        <title>客語例句學習</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <script src="js/jquery.min.js"></script>
        <script src="js/jquery.hotkeys.js"></script>
        <script src="js/bootstrap.min.js"></script>
        <script src="js/d3.v3.min.js"></script>
        <script>
            //分類的代碼表
            var categorys = {人體: 1, 稱謂: 2, 人際: 3, 飲食: 4, 服飾美容: 5,
                居處: 6, 交通: 7, 器物用品: 8, 休閒娛樂: 9, 代詞: 10,
                時間空間: 11, 疾病醫療: 12, 動作: 13, 歲時節慶: 14, 婚喪喜慶: 15,
                植物: 16, 動物: 17, 數詞量詞: 18, 品貌: 19, 宗教信仰: 20,
                虛詞: 21, 形容性狀: 22, 天文地理: 23, 思維心態: 24, 行業生產: 25,
                財政金融: 26, 教育文化: 27, 法政軍事: 28, 礦物: 29, 新聞新用語: 30};

            //詞彙
            var words = [];

            //目前顯示哪一個字的索引
            var currIndex = -1;

            //從檔案讀取詞彙資料
            d3.tsv('si_words.tsv', function(error, data) {
                data.forEach(function(d) {
                    d['categoryCode'] = categorys[d['類別']];
                    if (d['categoryCode'] < 10) {
                        d['categoryCode'] = '0' + d['categoryCode'];
                    }
                });
                words = data;
                randomPick();
                //console.log(data); 
            });

            //隨機選字
            var randomPick = function() {
                currIndex = Math.round(Math.random() * words.length);
                showWord(words[currIndex]);
            };

            //將文字顯示到網頁中
            var showWord = function(word) {
                $('#hakkeaWord').html(word['客家語言']);
                $('#mandarinWord').html(word['華語辭義']);
                $('#hakkaSentence').html(word['客語例句']);
                $('#mandarinSentence').html(word['華語翻譯']);
                var wordUrl = 'http://wiki.hakka.gov.tw/file/102/si/SI-' + word['categoryCode'] + '_' + word['序號'] + '.mp3';
                $('#wordPlayer source').attr('src', wordUrl);
                $('#wordPlayer').load();
                var sentenceUrl = 'http://wiki.hakka.gov.tw/file/102/si/SI-' + word['categoryCode'] + '_' + word['序號'] + 's.mp3';
                $('#sentencePlayer source').attr('src', sentenceUrl);
                $('#sentencePlayer').load();
            };

            $(document).on('ready', function() {
                $('#nextWord').on('click', randomPick);
                //設定按下鍵盤時的動作
                $(document).on('keydown', null, 'right', randomPick);
                $(document).on('keydown', null, 'down', randomPick);
            });
        </script>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <ul class="nav nav-pills pull-right">
                    <li class="active"><a href="#">Home</a></li>
                    <li><a href="#">About</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
                <h3 class="text-muted">客語例句學習</h3>
            </div>

            <div class="jumbotron">
                <h1>客語例句學習</h1>
                <p class="lead">提供給有客語基礎的人，藉由不斷地聽句子來學習客語。</p>
            </div>

            <div class="row marketing">
                <div class="col-md-8 col-md-offset-2">
                    <table class="table">
                        <thead>
                        </thead>
                        <tbody>
                            <tr>
                                <td>客語</td>
                                <td>
                                    <p id="hakkeaWord"></p>
                                    <audio id="wordPlayer" controls>
                                        <source src="http://wiki.hakka.gov.tw/file/102/si/SI-01_009.mp3" type="audio/mpeg">
                                    </audio>
                                </td>
                            </tr>
                            <tr>
                                <td>華語辭義</td>
                                <td> <p id="mandarinWord"></p></td>
                            </tr>
                            <tr>
                                <td>客語例句</td>
                                <td>
                                    <p id="hakkaSentence"></p>
                                    <audio id="sentencePlayer" controls>
                                        <source src="http://wiki.hakka.gov.tw/file/102/si/SI-01_009s.mp3" type="audio/mpeg">
                                    </audio>
                                </td>
                            </tr>
                            <tr>
                                <td>華語翻譯</td>
                                <td><p id="mandarinSentence"></p></td>
                            </tr>
                        </tbody>
                    </table>
                    <button type="button" class="btn btn-primary" id="nextWord">隨機下一句</button>
                </div>
            </div>

            <div class="footer">
                <p>&copy; <a href="https://github.com/gn02297012" target="_blank">Jimmy Liao</a> 2014</p>
            </div>

        </div> <!-- /container -->

    </body>
</html>
